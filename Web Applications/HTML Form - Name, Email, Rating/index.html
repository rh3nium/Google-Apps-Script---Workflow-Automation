<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <script>
      function sendToGAS(event) {
        event.preventDefault();
        var name = document.getElementById('name').value;
        var email = document.getElementById('email').value;
        var feedback = document.getElementById('feedback').value;
        var rating = document.getElementById('rating').value;
        google.script.run
        .withSuccessHandler(() => {
          alert('Thank You for your Feedback!');
          document.getElementById('myform').reset();
        })
        .withFailureHandler(() => {alert('Failure')})
        .recordDataAndSendEmails(name, email, feedback, rating);
      }
    </script>
  </head>
  
  <body>
    <h1>Feedback Form - Dynamic</h1>
    <form onsubmit="sendToGAS(event)" id="myform">
      Name: <br><br><br>
      <input type="text" id="name" required>
      <br><br><br>
      Email: <br><br><br>
      <input type="email" required id="email">
      <br><br><br>
      Feedback: <br><br><br>
      <input type="text" id="feedback" required>
      <br><br><br>
      Rating: 
      <br><br><br>
      <select id="rating" required>
        <option value="" disabled selected>Select rating</option>
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
      </select>
      <br><br><br>
      <input type="submit" value="Submit">
  </body>
  
</html>
